{
  "info": {
    "_postman_id": "570b48e9-a12c-4b7a-9fe6-f402836f9260",
    "name": "Ecommerce API Test (Complete)",
    "description": "İstenilen API'lerin hepsi ve bazı negatif senaryolar. Admin/User şifreleri minimum 8 karakter: user1234 / admin1234.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "47753162"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register (201)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('201', ()=>pm.response.to.have.status(201));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"Test User\",\n  \"email\":\"user2@test.com\",\n  \"password\":\"user1234\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/register",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "register" ]
            }
          },
          "response": []
        },
        {
          "name": "Register Invalid (422)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('422', ()=>pm.response.to.have.status(422));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"A\",\n  \"email\":\"nope\",\n  \"password\":\"123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/register",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "register" ]
            }
          },
          "response": []
        },
        {
          "name": "Login User (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));", "var json=pm.response.json(); pm.collectionVariables.set('token_user', json.data.token);" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\":\"user@test.com\",\n  \"password\":\"user1234\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "login" ]
            }
          },
          "response": []
        },
        {
          "name": "Login Admin (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));", "var json=pm.response.json(); pm.collectionVariables.set('token_admin', json.data.token);" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\":\"admin@test.com\",\n  \"password\":\"admin1234\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "login" ]
            }
          },
          "response": []
        },
        {
          "name": "Profile (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/profile",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "profile" ]
            }
          },
          "response": []
        },
        {
          "name": "Profile - Update (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"User Updated\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/profile",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "profile" ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Catalog",
      "item": [
        {
          "name": "Categories - List (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/categories",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "categories" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Create Category (201)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('201', ()=>pm.response.to.have.status(201));", "var json=pm.response.json(); pm.collectionVariables.set('category_id', json.data.id);" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"name\": \"Yeni Kategori\",\r\n  \"description\" : \"Açıklama\"\r\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/categories",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "categories" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Update Category (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Kategori (Güncellenmiş)\",\n  \"description\": \"Açıklama (Güncel)\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/categories/{{category_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "categories", "{{category_id}}" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Delete Category (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/categories/{{category_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "categories", "{{category_id}}" ]
            }
          },
          "response": []
        },
        {
          "name": "Products - List (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products?limit=5&search=.",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products" ],
              "query": [
                {
                  "key": "limit",
                  "value": "5"
                },
                {
                  "key": "search",
                  "value": "."
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Products - Show (200/404)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200 or 404', function(){ pm.expect([200,404]).to.include(pm.response.code); });" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products/1",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products", "1" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Create Product (201)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('201', ()=>pm.response.to.have.status(201));", "var json=pm.response.json(); pm.collectionVariables.set('product_id', json.data.id);" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"Deneme Ürün\",\n  \"price\": 49.90,\n  \"stock_quantity\": 20,\n  \"category_id\": {{category_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products" ]
            }
          },
          "response": []
        },
        {
          "name": "User - Create Product Forbidden (403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('403', ()=>pm.response.to.have.status(403));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"Yetkisiz\",\n  \"price\": 10,\n  \"stock_quantity\": 1,\n  \"category_id\": {{category_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Create Product Invalid (422)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('422', ()=>pm.response.to.have.status(422));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"ab\",\n  \"price\": -1,\n  \"stock_quantity\": -5,\n  \"category_id\": 0\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Update Product (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\":\"Deneme Ürün (Güncel)\",\n  \"price\": 59.90,\n  \"stock_quantity\": 25,\n  \"category_id\": {{category_id}}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/products/{{product_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products", "{{product_id}}" ]
            }
          },
          "response": []
        },
        {
          "name": "Admin - Delete Product (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/products/{{product_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "products", "{{product_id}}" ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Cart & Orders",
      "item": [
        {
          "name": "Cart - Get Unauthorized (401)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('401', ()=>pm.response.to.have.status(401));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/cart",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "cart" ]
            }
          },
          "response": []
        },
        {
          "name": "Cart - Add (201)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('201', ()=>pm.response.to.have.status(201));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"product_id\": {{product_id}},\n  \"quantity\": 2\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/cart/add",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "cart", "add" ]
            }
          },
          "response": []
        },
        {
          "name": "Orders - Create (201)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('201', ()=>pm.response.to.have.status(201));", "var json=pm.response.json(); pm.collectionVariables.set('order_id', json.data.id);" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "orders" ]
            }
          },
          "response": []
        },
        {
          "name": "Orders - Get List (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "orders" ]
            }
          },
          "response": []
        },
        {
          "name": "Orders - Get Detail (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "orders", "{{order_id}}" ]
            }
          },
          "response": []
        },
        {
          "name": "Orders - Create Empty Cart (400/422)",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [ "// Manuel deney: önce sepeti temizlediğinizden emin olun" ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('400 veya 422', function(){ pm.expect([400,422]).to.include(pm.response.code); });" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "orders" ]
            }
          },
          "response": []
        },
        {
          "name": "Cart - Update Qty (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"product_id\": {{product_id}},\n  \"quantity\": 3\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/cart/update",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "cart", "update" ]
            }
          },
          "response": []
        },
        {
          "name": "Cart - Remove Item (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/cart/remove/{{product_id}}",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "cart", "remove", "{{product_id}}" ]
            }
          },
          "response": []
        },
        {
          "name": "Cart - Clear (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_user}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/cart/clear",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "cart", "clear" ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Stats (200 admin / 403 user)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/admin/stats",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "admin", "stats" ]
            }
          },
          "response": []
        },
        {
          "name": "Update Order Status (200)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('200', ()=>pm.response.to.have.status(200));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"status\": \"PAID\" }"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/orders/{{order_id}}/status",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "admin", "orders", "{{order_id}}", "status" ]
            }
          },
          "response": []
        },
        {
          "name": "Update Order Status Invalid (422)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [ "pm.test('422', ()=>pm.response.to.have.status(422));" ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token_admin}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"status\": \"INVALID\" }"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/orders/{{order_id}}/status",
              "host": [ "{{base_url}}" ],
              "path": [ "api", "admin", "orders", "{{order_id}}", "status" ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "token_user",
      "value": ""
    },
    {
      "key": "token_admin",
      "value": ""
    },
    {
      "key": "category_id",
      "value": "1"
    },
    {
      "key": "product_id",
      "value": "1"
    },
    {
      "key": "order_id",
      "value": "1"
    }
  ]
}
